!function(a,e){"use strict";var t=a.jQuery;if("function"==typeof define&&define.amd)t?define([],e.bind(null,t)):define(["jquery"],e);else if("object"==typeof exports)t?module.exports=e(t):module.exports=e(require("jquery"));else{if(!t)throw"Missing required jQuery dependency";e(t)}}(this,function(a){function e(a,e,n){var r=a.find("canvas"),l=r[0],i=a.outerWidth(),s=a.innerWidth(),d=i-s;r.css("left",d*-1),r.css("top",d*-1);var o=(i-d/2)/2;l.width=i+d,l.height=l.width;var f=l.getContext("2d");f.clearRect(0,0,l.width,l.height),f.beginPath(),f.arc(l.width/2,l.width/2,o,t(e)-Math.PI/2,t(n)-Math.PI/2,!1),f.lineWidth=d/2,f.strokeStyle=r.css("color"),f.stroke()}function t(a){return a*(Math.PI/180)}function n(t){var n=t.find("input"),r=l(n),i=t.find(".handle"),s=t.find(".handle1"),d=n.val();if(!r)var o=t.find(".handle2");var f=t.outerWidth(),c=t.innerWidth(),u=(f-c)/2,v=(f-u)/2,p=parseFloat(n.attr("data-min"))||0,g=parseFloat(n.attr("data-max"))||360,h=void 0===n.attr("data-unit")?"&deg;":n.attr("data-unit"),m=g-p,w=360/m;i.each(function(e,n){var r=a(n),l=parseFloat(r.attr("data-value")),i=(l-p)*w,s=Math.round(v+v*Math.sin(i*Math.PI/180)),d=Math.round(v+v*-Math.cos(i*Math.PI/180));r.css({left:s,top:d}),t.find(r.attr("data-value-target")).html(r.attr("data-value")+h)});var y=[{source:"lcnCircleRangeSelect"}],M=s.attr("data-value");if(r)d!==M&&n.val(M).trigger("change",y);else{var F=o.attr("data-value");e(t,(M-p)*w,(F-p)*w);var x=M+";"+F;d!==x&&n.val(x).trigger("change",y)}}function r(e){var t=l(e);if(t)var r=parseFloat(e.val()||0);else{var d=e.val()||"0;0";d=d.split(";");var r=parseFloat(d[0]),o=parseFloat(d[1])}var f=a('<div class="circle-range-select-wrapper"></div>'),c=e.attr("data-bg-image");c&&f.css({"background-image":'url("'+c+'")',"background-size":"contain"}),e.wrap(f),f=e.parent(),f.append('<div class="handle handle1" data-value="'+r+'" data-value-target=".value1"></div>'),t?f.append('<div class="values"><span class="value1"></span></div>'):(f.append('<div class="handle handle2" data-value="'+o+'" data-value-target=".value2"></div>'),f.append('<div class="values"><span class="value1"></span> - <span class="value2"></span></div>'),f.append('<canvas class="selected-range"></canvas>')),n(f),f.on("mousedown touchstart",".handle",function(e){i=!0,e.preventDefault(),s=a(e.target),a(document).one("mouseup touchend",function(){i=!1,s=null})}),e.on("change",function(a,e){if(!e||"object"!=typeof e||"lcnCircleRangeSelect"!==e.source){var t=f.find("input"),r=l(t),i=f.find(".handle1");if(r)i.attr("data-value",parseFloat(t.val()||0));else{var s=f.find(".handle2"),d=t.val()||"0;0";d=d.split(";"),i.attr("data-value",parseFloat(d[0])),s.attr("data-value",parseFloat(d[1]))}n(f)}}),a(window).on("resize",n.bind(null,f))}function l(a){return void 0!==a.attr("data-single-value")&&"false"!==a.attr("data-single-value")}var i=!1,s=null;return a(document).on("mousemove touchmove",function(e){if(i){var t=a(e.target);if($draggingWrapper=t.closest(".circle-range-select-wrapper"),0===$draggingWrapper.length)return;if(s.hasClass("handle1")?$draggingHandle=$draggingWrapper.find(".handle1"):s.hasClass("handle2")&&($draggingHandle=$draggingWrapper.find(".handle2")),$draggingHandle[0]!==s[0])return;var r=s.closest(".circle-range-select-wrapper"),l=r.width()/2;if(!e.offsetX&&e.originalEvent.touches){var d=t.offset();e.offsetX=e.originalEvent.touches[0].pageX-d.left,e.offsetY=e.originalEvent.touches[0].pageY-d.top}else if("undefined"==typeof e.offsetX||"undefined"==typeof e.offsetY){var d=t.offset();e.offsetX=e.pageX-d.left,e.offsetY=e.pageY-d.top}if(t.hasClass("handle"))var o={x:e.target.offsetLeft+e.offsetX,y:e.target.offsetTop+e.offsetY};else var o={x:e.offsetX,y:e.offsetY};var f=Math.atan2(o.x-l,o.y-l),c=-f/(Math.PI/180)+180,u=r.find("input"),v=parseFloat(u.attr("data-min"))||0,p=parseFloat(u.attr("data-max"))||360,g=p-v,h=360/g,m=v+Math.round(c/h);s.attr("data-value",m),n(r)}}),a.fn.lcnCircleRangeSelect=function(){return this.each(function(){r(a(this))})},a(function(){a("input.circle-range-select[data-auto-init]").lcnCircleRangeSelect()}),a.fn.lcnCircleRangeSelect});