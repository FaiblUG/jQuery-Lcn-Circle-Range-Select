!function(t,e){var a=t.jQuery;if("function"==typeof define&&define.amd)a?define([],e.bind(null,a)):define(["jquery"],e);else if("object"==typeof exports)module.exports=e(a?a:require("jquery"));else{if(!a)throw"Missing required jQuery dependency";e(a)}}(this,function(t){function e(t,e,n){var i=t.find("canvas"),r=i[0],o=t.outerWidth(),d=t.innerWidth(),l=o-d;i.css("left",-1*l),i.css("top",-1*l);var s=(o-l/2)/2;r.width=o+l,r.height=r.width;var u=r.getContext("2d");u.clearRect(0,0,r.width,r.height),u.beginPath(),u.arc(r.width/2,r.width/2,s,a(e)-Math.PI/2,a(n)-Math.PI/2,!1),u.lineWidth=l/2,u.strokeStyle=i.css("color"),u.stroke()}function a(t){return t*(Math.PI/180)}function n(a){var n=a.find(".handle"),i=a.find(".handle1"),r=a.find(".handle2"),o=a.outerWidth(),d=a.innerWidth(),l=(o-d)/2,s=(n.outerWidth(),(o-l)/2),u=a.find("input"),f=parseFloat(u.attr("data-min"))||0,c=parseFloat(u.attr("data-max"))||360,v=void 0===u.attr("data-unit")?"&deg;":u.attr("data-unit"),h=c-f,p=360/h;n.each(function(e,n){var i=t(n),r=parseFloat(i.attr("data-value")),o=(r-f)*p,d=Math.round(s+s*Math.sin(o*Math.PI/180)),l=Math.round(s+s*-Math.cos(o*Math.PI/180));i.css({left:d,top:l}),a.find(i.attr("data-value-target")).html(i.attr("data-value")+v)}),value1=i.attr("data-value"),value2=r.attr("data-value"),e(a,(value1-f)*p,(value2-f)*p),u.val(value1+";"+value2).trigger("change")}function i(e){var a=e.val()||"0;0";a=a.split(";");var i=parseInt(a[0],10),d=parseInt(a[1],10);$container=t('<div class="circle-range-select-wrapper"></div>'),e.wrap($container),$container=e.parent(),$container.append('<div class="handle handle1" data-value="'+i+'" data-value-target=".value1"></div>'),$container.append('<div class="handle handle2" data-value="'+d+'" data-value-target=".value2"></div>'),$container.append('<div class="values"><span class="value1"></span> - <span class="value2"></span></div>'),$container.append('<canvas class="selected-range"></canvas>'),n($container),$container.on("mousedown touchstart",".handle",function(e){r=!0,e.preventDefault(),o=t(e.target),t(document).one("mouseup touchend",function(){r=!1,o=null})}),t(window).on("resize",n.bind(null,$container))}var r=!1,o=null;t(document).on("mousemove touchmove",function(e){if(r){var a=o.closest(".circle-range-select-wrapper"),i=a.width()/2;if(!e.offsetX&&e.originalEvent.touches){var d=t(e.target).offset();e.offsetX=e.originalEvent.touches[0].pageX-d.left,e.offsetY=e.originalEvent.touches[0].pageY-d.top}else if("undefined"==typeof e.offsetX||"undefined"==typeof e.offsetY){var d=t(e.target).offset();e.offsetX=e.pageX-d.left,e.offsetY=e.pageY-d.top}var l={x:e.target.offsetLeft+e.offsetX,y:e.target.offsetTop+e.offsetY},s=Math.atan2(l.x-i,l.y-i),u=-s/(Math.PI/180)+180,f=a.find("input"),c=parseFloat(f.attr("data-min"))||0,v=parseFloat(f.attr("data-max"))||360,h=v-c,p=360/h,g=c+Math.round(u/p);console.log(u,p,h,g),o.attr("data-value",g),n(a)}}),t.fn.lcnCircleRangeSelect=function(){return this.each(function(){i(t(this))})}});